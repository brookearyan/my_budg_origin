<!DOCTYPE html>
<html>
  <head>

    <style media="screen">
      body {
        background-color: #FAFBFC;
      }
      .footer{
        font-family: 'Open Sans', sans-serif;
        text-align: right;

      }
      .totals {
        font-family: 'Open Sans', sans-serif;
        color: #263675;
        font-size: 16px;
      }

      h1, h2, h4, h5 {
        font-family: 'Lora', serif;
        color: #808080;
      }
      h3 a {
        font-family: 'Open Sans', sans-serif;
        color: #263675;
        font-size: 16px;
        margin-left: 10px;
      }
      a:hover {
        text-decoration: none;
        color: black;

      }

      h4 {
        font-size: 24px;
      }

      h1 {
        margin-top: 35px;
        font-size: 20px;
        text-align: center;
        color: #C0C0C0;

      }
      p {
      font-family: 'Open Sans', sans-serif;
      color: #808080;
      margin-left: 8px;
      margin-right: 10px;
      font-size: 16px;
      }

    </style>
    <meta charset="utf-6">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="/user.js" type="text/javascript">

    </script>
    <title></title>
  </head>
  <body>
    <% provide(:title, @user.name) %>
    <div class="user-profile">
        <section class="user-info">
          <h1>mybudg profile</h1><br>
          <table id="user">
            </table>
      </div>
        <div class="expenses">
          <h1>my expenses</h1><br>
          <!-- <% @expenses = Expense.all.select { |e| e.user_id == current_user.id } %>
          <% @expenses.each do |e| %>
          <h4>name: <%= e.name %> | type: <%= e.expense_type %> | cost: $<%= e.cost %></h4><br>
          <% end %>
          <% $expenses = @expenses.map! { |b| b.cost.to_i } %>
          <h4>total: $<%= $expenses.reduce(:+) %></h4> -->
        </div>
        <div class="bills">
          <h1>my bills</h1><br>
          <!-- <% @bills = Bill.all.select { |e| e.user_id == current_user.id } %>
          <% @bills.each do |e| %>
          <h4>name: <%= e.company %> | type: <%= e.bill_type %> | cost: $<%= e.cost %></h4><br>
          <% end %>
          <% $bills = @bills.map! { |b| b.cost.to_i } %>
          <h4>total: $<%= $bills.reduce(:+) %></h4> -->
        </div>
          <div class="footer">
          <h3><%= link_to "add expenses", new_expense_path(current_user) %> |
          <%= link_to "add bills", new_bill_path(current_user) %></h3>
        </div>
<tr>
  <td></td><td></td>
</tr>
        <script>
          $(document).ready(function(){
            const url = window.location.href;
            fetch(url, {
                headers :
                { 'Content-Type': 'application/json',
                'Accept': 'application/json' }
                })
                .then(res => res.json())
                .then(json => userCont(json));

              function userCont(json) {
                var formatter = new Intl.NumberFormat('en-US', {
                  style: 'currency',
                  currency: 'USD',
                  minimumFractionDigits: 2,
                });
                let income = formatter.format(json.income);
                let afterTax = Math.floor(json['income']*=.65);
                let monthly = Math.floor(afterTax/=12);
                let expList = json['expenses']

                let afterTaxF = formatter.format(afterTax);
                let monthlyF = formatter.format(monthly);


                const userInfo =
                `<tr>
                  <th colspan="6">${json.name}</th>
                </tr>
                <tr>
                <td> email: </td><td>${json.email}</td>
                </tr>
                <tr>
                <td> password: </td><td> *********** </td>
                </tr>
                </tr>
                <td> zipcode: </td><td>${json.zipcode}</td>
                <tr>
                </tr>
                <td> annual income: </td><td>${income}</td>
                <tr>
                </tr>
                <td> after-tax income: </td><td>${afterTaxF}</td>
                <tr>
                </tr>
                <td> monthly gross income: </td><td>${monthlyF}</td>
                <tr>`;
                $('#user').append(userInfo);

                const expInfo =

                expList.forEach 

console.log(userExp.forEach);

              }
            })


        </script>
        <!-- // let id = window.location.href


  </body>
</html>
